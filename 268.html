<!DOCTYPE html >
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p268" style="overflow: hidden; position: relative; background-color: white; width: 811px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	-webkit-transform-origin: bottom left;
	-ms-transform-origin: bottom left;
	transform-origin: bottom left;
	-webkit-transform: scale(0.25);
	-ms-transform: scale(0.25);
	transform: scale(0.25);
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_268{left:703px;bottom:960px;}
#t2_268{left:323px;bottom:960px;}
#t3_268{left:156px;bottom:888px;word-spacing:0.1px;}
#t4_268{left:185px;bottom:873px;letter-spacing:0.1px;word-spacing:-0.1px;}
#t5_268{left:156px;bottom:857px;}
#t6_268{left:156px;bottom:827px;}
#t7_268{left:185px;bottom:811px;letter-spacing:0.1px;word-spacing:-0.1px;}
#t8_268{left:215px;bottom:796px;letter-spacing:0.1px;}
#t9_268{left:215px;bottom:781px;letter-spacing:0.1px;}
#ta_268{left:185px;bottom:766px;}
#tb_268{left:156px;bottom:750px;}
#tc_268{left:156px;bottom:716px;word-spacing:1.6px;}
#td_268{left:681px;bottom:717px;letter-spacing:0.1px;}
#te_268{left:156px;bottom:697px;letter-spacing:0.1px;}
#tf_268{left:186px;bottom:697px;letter-spacing:0.1px;}
#tg_268{left:156px;bottom:677px;letter-spacing:0.1px;word-spacing:1.7px;}
#th_268{left:380px;bottom:678px;}
#ti_268{left:393px;bottom:677px;letter-spacing:0.1px;word-spacing:1.7px;}
#tj_268{left:542px;bottom:678px;letter-spacing:0.1px;}
#tk_268{left:582px;bottom:677px;letter-spacing:0.1px;word-spacing:1.7px;}
#tl_268{left:156px;bottom:658px;word-spacing:3.2px;}
#tm_268{left:156px;bottom:638px;letter-spacing:0.1px;word-spacing:6.5px;}
#tn_268{left:156px;bottom:619px;letter-spacing:0.1px;}
#to_268{left:179px;bottom:599px;letter-spacing:0.1px;word-spacing:3.5px;}
#tp_268{left:264px;bottom:599px;letter-spacing:0.1px;}
#tq_268{left:304px;bottom:599px;letter-spacing:0.1px;word-spacing:3.5px;}
#tr_268{left:387px;bottom:600px;}
#ts_268{left:414px;bottom:599px;letter-spacing:0.1px;word-spacing:3.5px;}
#tt_268{left:482px;bottom:599px;}
#tu_268{left:521px;bottom:599px;word-spacing:3.5px;}
#tv_268{left:156px;bottom:579px;letter-spacing:0.1px;word-spacing:-0.6px;}
#tw_268{left:156px;bottom:560px;letter-spacing:-0.1px;word-spacing:0.1px;}
#tx_268{left:156px;bottom:490px;letter-spacing:0.1px;}
#ty_268{left:178px;bottom:475px;letter-spacing:0.1px;}
#tz_268{left:156px;bottom:460px;}
#t10_268{left:156px;bottom:434px;}
#t11_268{left:185px;bottom:419px;letter-spacing:0.1px;word-spacing:-0.1px;}
#t12_268{left:215px;bottom:403px;letter-spacing:0.1px;}
#t13_268{left:185px;bottom:388px;}
#t14_268{left:185px;bottom:373px;}
#t15_268{left:156px;bottom:357px;}
#t16_268{left:156px;bottom:324px;word-spacing:-0.6px;}
#t17_268{left:156px;bottom:304px;letter-spacing:0.1px;word-spacing:0.2px;}
#t18_268{left:156px;bottom:284px;letter-spacing:-0.1px;word-spacing:5.9px;}
#t19_268{left:545px;bottom:284px;letter-spacing:0.1px;}
#t1a_268{left:570px;bottom:284px;letter-spacing:0.1px;word-spacing:5.5px;}
#t1b_268{left:156px;bottom:265px;letter-spacing:0.1px;word-spacing:-0.1px;}
#t1c_268{left:370px;bottom:265px;}
#t1d_268{left:383px;bottom:265px;letter-spacing:0.1px;word-spacing:-0.2px;}
#t1e_268{left:179px;bottom:245px;letter-spacing:0.1px;word-spacing:3.8px;}
#t1f_268{left:712px;bottom:245px;letter-spacing:0.2px;}
#t1g_268{left:156px;bottom:225px;}
#t1h_268{left:186px;bottom:225px;letter-spacing:0.1px;}
#t1i_268{left:209px;bottom:225px;word-spacing:1.3px;}
#t1j_268{left:626px;bottom:226px;}
#t1k_268{left:639px;bottom:225px;letter-spacing:0.1px;word-spacing:0.9px;}
#t1l_268{left:156px;bottom:206px;letter-spacing:0.1px;word-spacing:-1.6px;}
#t1m_268{left:288px;bottom:206px;}
#t1n_268{left:295px;bottom:206px;letter-spacing:-0.2px;word-spacing:-1.4px;}
#t1o_268{left:392px;bottom:206px;}
#t1p_268{left:404px;bottom:206px;word-spacing:-1.7px;}
#t1q_268{left:156px;bottom:186px;letter-spacing:0.1px;}
#t1r_268{left:186px;bottom:186px;letter-spacing:0.1px;word-spacing:-0.1px;}
#t1s_268{left:416px;bottom:186px;}
#t1t_268{left:471px;bottom:186px;letter-spacing:0.1px;word-spacing:-0.3px;}
#t1u_268{left:564px;bottom:186px;}
#t1v_268{left:571px;bottom:186px;}
#t1w_268{left:593px;bottom:186px;}
#t1x_268{left:606px;bottom:186px;letter-spacing:0.1px;word-spacing:-0.2px;}
#t1y_268{left:156px;bottom:166px;letter-spacing:-0.2px;word-spacing:11.1px;}
#t1z_268{left:406px;bottom:166px;letter-spacing:0.1px;}
#t20_268{left:430px;bottom:166px;letter-spacing:0.1px;}
#t21_268{left:156px;bottom:146px;letter-spacing:0.1px;word-spacing:-1.6px;}
#t22_268{left:298px;bottom:146px;letter-spacing:0.1px;}
#t23_268{left:357px;bottom:146px;letter-spacing:0.1px;word-spacing:-1.4px;}
#t24_268{left:450px;bottom:146px;}
#t25_268{left:457px;bottom:146px;}
#t26_268{left:156px;bottom:126px;letter-spacing:0.1px;}
#t27_268{left:167px;bottom:97px;letter-spacing:0.1px;}
#t28_268{left:235px;bottom:97px;}
#t29_268{left:443px;bottom:96px;letter-spacing:0.1px;}
#t2a_268{left:127px;bottom:82px;}
#t2b_268{left:384px;bottom:81px;letter-spacing:0.1px;}
#t2c_268{left:414px;bottom:82px;letter-spacing:0.1px;}
#t2d_268{left:174px;bottom:916px;word-spacing:0.1px;}
#t2e_268{left:262px;bottom:916px;word-spacing:-0.1px;}
#t2f_268{left:174px;bottom:518px;word-spacing:0.1px;}
#t2g_268{left:262px;bottom:518px;}
#t2h_268{left:466px;bottom:881px;letter-spacing:-0.1px;word-spacing:0.1px;}
#t2i_268{left:466px;bottom:867px;word-spacing:-0.1px;}
#t2j_268{left:466px;bottom:774px;word-spacing:0.1px;}
#t2k_268{left:466px;bottom:760px;}
#t2l_268{left:466px;bottom:484px;word-spacing:-0.1px;}
#t2m_268{left:466px;bottom:469px;word-spacing:-0.1px;}
#t2n_268{left:427px;bottom:389px;letter-spacing:-0.8px;word-spacing:1px;}
#t2o_268{left:427px;bottom:375px;word-spacing:0.1px;}
#t2p_268{left:549px;bottom:82px;}
#t2q_268{left:559px;bottom:82px;}
#t2r_268{left:565px;bottom:82px;}
#t2s_268{left:612px;bottom:82px;}
#t2t_268{left:645px;bottom:82px;}
#t2u_268{left:716px;bottom:82px;}
#t2v_268{left:486px;bottom:145px;}
#t2w_268{left:550px;bottom:145px;}
#t2x_268{left:512px;bottom:131px;}
#t2y_268{left:537px;bottom:131px;}
#t2z_268{left:486px;bottom:117px;}
#t30_268{left:157px;bottom:8px;}

.s1_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: NewBaskerville-Bold_jp;
	color: rgb(37,37,37);
}

.s2_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: NewBaskerville-BoldItalic_kf;
	color: rgb(101,101,101);
}

.s3_268{
	FONT-SIZE: 48.8px;
	FONT-FAMILY: Courier_uq;
	color: rgb(37,37,37);
}

.s4_268{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: NewBaskerville-Roman_ja;
	color: rgb(37,37,37);
}

.s5_268{
	FONT-SIZE: 57.9px;
	FONT-FAMILY: Courier_uq;
	color: rgb(37,37,37);
}

.s6_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: NewBaskerville-Roman_ja;
	color: rgb(37,37,37);
}

.s7_268{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: NewBaskerville-Italic_j9;
	color: rgb(37,37,37);
}

.s8_268{
	FONT-SIZE: 48.8px;
	FONT-FAMILY: FranklinGothic-Demi_ka;
	color: rgb(101,101,101);
}

.s9_268{
	FONT-SIZE: 57.9px;
	FONT-FAMILY: Courier-Bold_yf;
	color: rgb(101,101,101);
}

.sa_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: FranklinGothic-Demi_ka;
	color: rgb(255,255,255);
}

.sb_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: Humanist521BT-BoldCondensed_vt;
	color: rgb(101,101,101);
}

.sc_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: Humanist521BT-BoldCondensed_vt;
	color: rgb(102,102,102);
}

.sd_268{
	FONT-SIZE: 55px;
	FONT-FAMILY: Humanist521BT-BoldCondensed_xu;
	color: rgb(102,102,102);
}

.se_268{
	FONT-SIZE: 42.8px;
	FONT-FAMILY: Courier-Bold_zr;
	color: rgb(72,109,180);
}

.sf_268{
	FONT-SIZE: 42.8px;
	FONT-FAMILY: Courier_12_;
	color: rgb(0,0,0);
}

.sg_268{
	FONT-SIZE: 61.1px;
	FONT-FAMILY: Helvetica, Arial, sans-serif;
	color: rgb(0,0,0);
	FONT-WEIGHT: bold;
}

</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts268" type="text/css" >

@font-face {
	font-family: Courier-Bold_yf;
	src: url("fonts/Courier-Bold_yf.woff") format("woff");
}

@font-face {
	font-family: Courier-Bold_zr;
	src: url("fonts/Courier-Bold_zr.woff") format("woff");
}

@font-face {
	font-family: Courier_12_;
	src: url("fonts/Courier_12_.woff") format("woff");
}

@font-face {
	font-family: Courier_uq;
	src: url("fonts/Courier_uq.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-Demi_ka;
	src: url("fonts/FranklinGothic-Demi_ka.woff") format("woff");
}

@font-face {
	font-family: Humanist521BT-BoldCondensed_vt;
	src: url("fonts/Humanist521BT-BoldCondensed_vt.woff") format("woff");
}

@font-face {
	font-family: Humanist521BT-BoldCondensed_xu;
	src: url("fonts/Humanist521BT-BoldCondensed_xu.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-BoldItalic_kf;
	src: url("fonts/NewBaskerville-BoldItalic_kf.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Bold_jp;
	src: url("fonts/NewBaskerville-Bold_jp.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Italic_j9;
	src: url("fonts/NewBaskerville-Italic_j9.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Roman_ja;
	src: url("fonts/NewBaskerville-Roman_ja.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg268Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg268" style="-webkit-user-select: none;"><object width="811" height="1017" data="268/268.svg" type="image/svg+xml" id="pdf268" style="width:811px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div id="t1_268" class="t s1_268">241</div>
<div id="t2_268" class="t s2_268">Variance: generics and subtyping</div>
<div id="t3_268" class="t s3_268">class Cat : Animal() {</div>
<div id="t4_268" class="t s3_268">fun cleanLitter() { ... }</div>
<div id="t5_268" class="t s3_268">}</div>
<div id="t6_268" class="t s3_268">fun takeCareOfCats(cats: Herd&lt;Cat&gt;) {</div>
<div id="t7_268" class="t s3_268">for (i in 0 until cats.size) {</div>
<div id="t8_268" class="t s3_268">cats[i].cleanLitter()</div>
<div id="t9_268" class="t s3_268">// feedAll(cats)</div>
<div id="ta_268" class="t s3_268">}</div>
<div id="tb_268" class="t s3_268">}</div>
<div id="tc_268" class="t s4_268">Unfortunately, the cats will remain hungry: if you tried to pass the herd to the </div>
<div id="td_268" class="t s5_268">feed-</div>
<div id="te_268" class="t s5_268">All</div>
<div id="tf_268" class="t s4_268">function, you’d get a type-mismatch error during compilation. Because you don’t</div>
<div id="tg_268" class="t s4_268">use any variance modifier on the </div>
<div id="th_268" class="t s5_268">T</div>
<div id="ti_268" class="t s4_268">type parameter in the </div>
<div id="tj_268" class="t s5_268">Herd</div>
<div id="tk_268" class="t s4_268">class, the herd of cats</div>
<div id="tl_268" class="t s4_268">isn’t a subclass of the herd of animals. You could use an explicit cast to work around</div>
<div id="tm_268" class="t s4_268">the problem, but that approach is verbose, error-prone, and almost never a correct</div>
<div id="tn_268" class="t s4_268">way to deal with a type-mismatch problem.</div>
<div id="to_268" class="t s4_268">Because the </div>
<div id="tp_268" class="t s5_268">Herd</div>
<div id="tq_268" class="t s4_268">class has an </div>
<div id="tr_268" class="t s6_268">API</div>
<div id="ts_268" class="t s4_268">similar to </div>
<div id="tt_268" class="t s5_268">List</div>
<div id="tu_268" class="t s4_268">and doesn’t allow its clients to</div>
<div id="tv_268" class="t s4_268">add or change the animals in the herd, you can make it covariant and change the call-</div>
<div id="tw_268" class="t s4_268">ing code accordingly.</div>
<div id="tx_268" class="t s3_268">class Herd&lt;out T : Animal&gt; {</div>
<div id="ty_268" class="t s3_268">...</div>
<div id="tz_268" class="t s3_268">}</div>
<div id="t10_268" class="t s3_268">fun takeCareOfCats(cats: Herd&lt;Cat&gt;) {</div>
<div id="t11_268" class="t s3_268">for (i in 0 until cats.size) {</div>
<div id="t12_268" class="t s3_268">cats[i].cleanLitter()</div>
<div id="t13_268" class="t s3_268">}</div>
<div id="t14_268" class="t s3_268">feedAll(cats)</div>
<div id="t15_268" class="t s3_268">}</div>
<div id="t16_268" class="t s4_268">You can’t make any class covariant: it would be unsafe. Making the class covariant on a</div>
<div id="t17_268" class="t s4_268">certain type parameter constrains the possible uses of this type parameter in the class.</div>
<div id="t18_268" class="t s4_268">To guarantee type safety, it can be used only in so-called </div>
<div id="t19_268" class="t s7_268">out</div>
<div id="t1a_268" class="t s4_268">positions, meaning the</div>
<div id="t1b_268" class="t s4_268">class can produce values of type </div>
<div id="t1c_268" class="t s5_268">T</div>
<div id="t1d_268" class="t s4_268">but not consume them.</div>
<div id="t1e_268" class="t s4_268">Uses of a type parameter in declarations of class members can be divided into </div>
<div id="t1f_268" class="t s7_268">in</div>
<div id="t1g_268" class="t s4_268">and </div>
<div id="t1h_268" class="t s7_268">out</div>
<div id="t1i_268" class="t s4_268">positions. Let’s consider a class that declares a type parameter </div>
<div id="t1j_268" class="t s5_268">T</div>
<div id="t1k_268" class="t s4_268">and contains</div>
<div id="t1l_268" class="t s4_268">a function that uses </div>
<div id="t1m_268" class="t s5_268">T</div>
<div id="t1n_268" class="t s4_268">. We say that if </div>
<div id="t1o_268" class="t s5_268">T</div>
<div id="t1p_268" class="t s4_268">is used as the return type of a function, it’s in the</div>
<div id="t1q_268" class="t s5_268">out</div>
<div id="t1r_268" class="t s4_268">position. In this case, the function </div>
<div id="t1s_268" class="t s7_268">produces</div>
<div id="t1t_268" class="t s4_268">values of type </div>
<div id="t1u_268" class="t s5_268">T</div>
<div id="t1v_268" class="t s4_268">. If </div>
<div id="t1w_268" class="t s5_268">T</div>
<div id="t1x_268" class="t s4_268">is used as the type</div>
<div id="t1y_268" class="t s4_268">of a function parameter, it’s in the </div>
<div id="t1z_268" class="t s5_268">in</div>
<div id="t20_268" class="t s4_268">posi-</div>
<div id="t21_268" class="t s4_268">tion. Such a function </div>
<div id="t22_268" class="t s7_268">consumes</div>
<div id="t23_268" class="t s4_268">values of type </div>
<div id="t24_268" class="t s5_268">T</div>
<div id="t25_268" class="t s4_268">.</div>
<div id="t26_268" class="t s4_268">Figure 9.6 illustrates this.</div>
<div id="t27_268" class="t s8_268">Figure 9.6</div>
<div id="t28_268" class="t s8_268">The function parameter type is called </div>
<div id="t29_268" class="t s9_268">in</div>
<div id="t2a_268" class="t s8_268">position, and the function return type is called </div>
<div id="t2b_268" class="t s9_268">out</div>
<div id="t2c_268" class="t s8_268">position.</div>
<div id="t2d_268" class="t sa_268">Listing 9.12</div>
<div id="t2e_268" class="t sa_268">Using an invariant collection-like class</div>
<div id="t2f_268" class="t sa_268">Listing 9.13</div>
<div id="t2g_268" class="t sa_268">Using a covariant collection-like class</div>
<div id="t2h_268" class="t sb_268">A Cat is</div>
<div id="t2i_268" class="t sb_268">an Animal.</div>
<div id="t2j_268" class="t sb_268">Error: inferred type is Herd&lt;Cat&gt;, </div>
<div id="t2k_268" class="t sb_268">but Herd&lt;Animal&gt; was expected</div>
<div id="t2l_268" class="t sb_268">The T parameter is </div>
<div id="t2m_268" class="t sb_268">now covariant.</div>
<div id="t2n_268" class="t sb_268">You don’t </div>
<div id="t2o_268" class="t sb_268">need a cast.</div>
<div id="t2p_268" class="t sc_268">“i</div>
<div id="t2q_268" class="t sd_268">n</div>
<div id="t2r_268" class="t sc_268">” positio</div>
<div id="t2s_268" class="t sd_268">n</div>
<div id="t2t_268" class="t sc_268">“out” positio</div>
<div id="t2u_268" class="t sd_268">n</div>
<div id="t2v_268" class="t se_268">interface </div>
<div id="t2w_268" class="t sf_268">Transformer&lt;T&gt; {</div>
<div id="t2x_268" class="t se_268">fun </div>
<div id="t2y_268" class="t sf_268">transform(t: T): T</div>
<div id="t2z_268" class="t sf_268">}</div>
<div id="t30_268" class="t sg_268">Licensed to Édouard WILLISSECK &lt;edouard.willisseck@gmail.com&gt;</div>

<!-- End text definitions -->


</div>
</body>
</html>
